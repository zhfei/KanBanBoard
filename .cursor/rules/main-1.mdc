---
alwaysApply: true
---
# 整体产品设计文档

## 1. 背景

本项目旨在实现一个**看板任务管理（Kanban Board）**系统，用于支持类似 Trello 的任务流转与协作。核心体验是任务卡片在 **Todo / Doing / Done** 三个状态列之间的拖拽移动，并实现数据的可靠同步。

### 1.1 项目目标

- 提供任务创建、编辑、删除与状态流转能力。
- 支持任务在看板列之间**拖拽**，并即时反映到后端与数据库。
- 形成可一键启动的全栈交付物，支持项目演示与二次开发。

### 1.2 范围（Scope）

**包含：**

- Web 前端（看板 UI、拖拽交互、任务 CRUD）
- 后端 API（任务、看板列、同步、校验、错误处理）
- 数据库（任务与状态持久化、基础索引）
- Docker Compose 一键联调

**不包含（当前阶段不做）：**

- 多租户、组织/团队权限体系
- 复杂审计日志、工作流自定义
- 离线优先与冲突合并（可留作后续增强）

### 1.3 交付与验收标准

- 根目录必须包含 `docker-compose.yml`。
- 执行 `docker compose up` 后可以一键启动并访问（包含前端与后端服务）。
- 前后端与数据库可联调：拖拽后刷新页面数据不丢失。
- 项目结构清晰，符合企业级工程标准：
    - 错误处理、日志
    - 输入校验
    - 接口设计清晰
    - 组件化、通用工具封装

---

## 2. 用户与使用场景

### 2.1 目标用户

- 个人开发者或小团队：需要简单的任务管理与流程可视化

### 2.2 核心场景

1. 用户打开看板，看到 Todo/Doing/Done 三列。
2. 用户新建任务，默认进入 Todo。
3. 用户拖拽任务卡片从 Todo 到 Doing，再到 Done。
4. 用户刷新页面或重新打开，任务状态保持不变。

---

## 3. 需求分析

### 3.1 功能需求（MVP）

**看板与列：**

- 系统提供固定三列：Todo / Doing / Done（第一版可写死，后续可配置化）。

**任务：**

- 创建任务：标题必填，描述可选
- 编辑任务：标题、描述、状态
- 删除任务
- 列表展示：按状态分组展示在三列中

**拖拽：**

- 支持卡片在列之间拖拽
- 拖拽完成后立即调用 API 更新状态
- 更新失败时给出提示并回滚 UI 状态（或刷新数据恢复）

**同步：**

- 前端初始加载通过 API 获取任务列表
- 任何增删改都通过 API 持久化

### 3.2 非功能需求

- **可维护性：**模块拆分清晰，便于扩展
- **可靠性：**错误处理完整，避免“静默失败”
- **可观测性：**日志可定位问题
- **一致性：**接口返回结构统一
- **可部署性：**Docker Compose 一键启动

---

## 4. 产品方案（整体设计）

### 4.1 信息架构

- 首页：Kanban 看板
    - 顶部：项目标题/简单导航
    - 主体：三列（Todo/Doing/Done）
        - 每列：任务卡片列表
    - 操作：新建任务按钮

### 4.2 关键交互

- **拖拽交互：**
    - 按下任务卡片可拖拽
    - 拖入目标列后触发落点动画
    - 落点后立即保存（API）
    - 保存失败：提示错误并恢复原列
- **任务编辑：**
    - 点击卡片打开详情（弹窗或侧边栏均可，第一版建议弹窗）
    - 支持修改标题、描述、状态

### 4.3 状态模型

- Task.status ∈ {"Todo", "Doing", "Done"}
- 任务在列间移动本质是 status 变更

---

## 5. API 设计（对齐产品需求）

> 具体技术实现可在《整体技术设计文档》中细化，这里只定义产品所需的能力与基本契约。
> 

### 5.1 建议的接口清单

- `GET /api/tasks`：获取全部任务（可按 status 过滤）
- `POST /api/tasks`：创建任务
- `GET /api/tasks/{id}`：获取单个任务
- `PUT /api/tasks/{id}`：更新任务（包含 status 更新，用于拖拽）
- `DELETE /api/tasks/{id}`：删除任务

### 5.2 返回结构建议

- 统一包装：`code / message / data`
- 错误返回包含可读 message 与可定位 errorId（可选）

---

## 6. 数据设计（概念模型）

### 6.1 任务表（Task）

- id（主键）
- title（必填）
- description（可选）
- status（Todo/Doing/Done）
- created_at / updated_at

### 6.2 索引建议

- status 索引（提升按列加载性能）

---

## 7. 工程与交付约束（必须遵守）

### 7.1 Docker 化

- 根目录提供 `docker-compose.yml`
- `docker compose up` 一键启动：
    - 前端服务
    - 后端服务
    - 数据库服务

### 7.2 企业项目标准体现

- 参数校验：请求体与路径参数都要校验
- 错误处理：清晰的异常分层与错误码
- 日志：请求日志与关键业务日志
- 组件化：前端组件拆分合理
- 通用工具封装：例如 API client、错误处理器、配置加载等

### 7.3 设计原则（工程约束）

遵循以下软件设计原则：

- 单一职责原则（SRP）
- 开闭原则（OCP）
- 接口隔离原则（ISP）
- 依赖倒置原则（DIP）
- 里式替换原则（LSP）
- 迪米特法则（LoD）

---

## 8. 实施计划（MVP）

### 8.1 里程碑

1. 数据库与后端基础（表结构、CRUD、统一错误返回）
2. 前端看板页面（列布局、任务渲染、新建任务）
3. 拖拽交互（UI + 状态更新 API）
4. Docker Compose 联调与验收

### 8.2 风险与应对

- 拖拽后保存失败：需要回滚 UI 或强制刷新数据
- 环境一致性：使用 Docker 固化依赖，避免“本地能跑”问题

---

## 9. 代码仓库位置

- 代码仓库：https://github.com/zhfei/KanBanBoard.git
